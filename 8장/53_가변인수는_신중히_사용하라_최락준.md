# 아이템 53 가변인수는 신중히 사용하라

## 가변인수(varargs)란?

* 가변인수는 명시된 타입의 인수를 **0개 이상** 받기 위해 사용합니다.
* 가변인수 메서드를 호출하면, 호출시의 **인수의 갯수만큼의 사이즈를 가진 배열을 만들고**, 이를 배열에 저장하여 메서드에 건내줍니다.
* 다음과 같이 가변인수를 사용하여 건네진 인수의  평균을 구할 수 있습니다.
```java
    public int average(int... args) {
        int sum = 0;
        int size = args.length;
        for (int arg : args) {
            sum += arg;
        }
        return sum / size;
    }
```

## 사용법 1 - 필수 인수를 지정하라.

위의 average() 메서드에는 한가지 문제가 있습니다.

바로 인수의 개수가 0개일 때 마지막 나눗셈에서 분모가 0이 되기 때문에 런타임시 에러를 발생시킨다는 점입니다.

이를 방지하기 위해서는 다음의 코드를 추가할 수 있습니다.

```java
	if(args.length == 0) throw new IllegalArgumentException();
```

하지만 이 방법 역시, 컴파일 타임이 아닌 런타임에 에러를 발생시키게 되고, 코드도 지저분해 진다는 단점을 갖고 있다.

이는 가변인수 외에 필수 인수를 지정하는 방법으로 해결할 수 있습니다.

```java
public int average(int first, int... args) {
	int sum = first;
	int size = args.length + 1;
	for (int arg : args) {
	    sum += arg;
	}
	return sum / size;
}
```
이처럼 필수 인수를 지정하므로써, 메서드에 전달되는 인수의 갯수가 0개가 되는 것을 방지할 수 있습니다.

이 방법은 불필요한 예외처리가 필요 없고, 런타임에 에러를 발생시키지 않습니다.

## 사용법 2 - 성능에 민감한 경우 다중 정의와 함께

가변인수는 호출될 때 **인수의 갯수만큼의 사이즈를 가진 배열을 만들기 때문에** 성능에 민감한 경우 걸림돌이 될 수 있습니다.

이 경우에는 다중 정의를 활용하여 우회할 수 있습니다.

만약 메서드 호출의 95%가 3개 이하의 인자를 가진 메서드 호출에 집중된다면, 1~3개의 인수를 받는 메서드를 각각 정의하고

4개 이상의 인수를 받는 메서드를 가변인수 메서드로 정의합니다.

```java
public void foo() {}

public void foo(int a1) {}

public void foo(int a1, int a2) {}

public void foo(int a1, int a2, int a3) {}

public void foo(int a1, int... args) {}
```

이 방법을 사용하면 5%의 메서드 호출에서만 가변인수 메서드를 사용하기 때문에 유연성을 지키면서도 성능 이슈를 최소화할 수 있습니다.

## 정리

`인수의 개수가 유동적일 경우 가변인수를 사용하라.`

`필수 인수가 있을 경우 가변인수와 함께 선언하자.`

`성능 문제가 있을 경우 다중 정의와 함께 사용할 수 있다.`
